================================================================================
COMPLETE DATA FLOW - USER JOURNEY WALKTHROUGH
================================================================================

This document traces the complete journey of data through your application
for different user actions. Follow along to understand how everything connects.


FLOW 1: USER SIGNUP
================================================================================

USER ACTION: Click "Sign Up" and fill form

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: FRONTEND (React - Signup.jsx)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ User enters:                                                             â”‚
â”‚   - Name: "John Doe"                                                     â”‚
â”‚   - Email: "john@email.com"                                              â”‚
â”‚   - Password: "mypass123"                                                â”‚
â”‚                                                                          â”‚
â”‚ User clicks "Sign Up" button                                            â”‚
â”‚                                                                          â”‚
â”‚ JavaScript code executes:                                               â”‚
â”‚   const handleSignup = async (e) => {                                   â”‚
â”‚     e.preventDefault();                                                 â”‚
â”‚     await signup(name, email, password);  // Call context function      â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: AUTHCONTEXT (React Context)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ signup function in AuthContext.jsx:                                     â”‚
â”‚                                                                          â”‚
â”‚   const signup = async (name, email, password) => {                     â”‚
â”‚     const response = await authAPI.signup(name, email, password);       â”‚
â”‚     // Will handle response after API call                              â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: API SERVICE (api.js)                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ authAPI.signup() makes HTTP request:                                    â”‚
â”‚                                                                          â”‚
â”‚   signup: (name, email, password) => {                                  â”‚
â”‚     return api.post('/signup', null, {                                  â”‚
â”‚       params: { name, email, password }                                 â”‚
â”‚     });                                                                 â”‚
â”‚   }                                                                     â”‚
â”‚                                                                          â”‚
â”‚ HTTP Request sent:                                                      â”‚
â”‚   POST http://localhost:8000/signup?name=John&email=john@email.com     â”‚
â”‚        &password=mypass123                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
                    [DATA TRAVELS OVER NETWORK]
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: BACKEND (FastAPI - fastapi_test.py)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @app.post("/signup") endpoint receives request:                         â”‚
â”‚                                                                          â”‚
â”‚   async def signup(                                                     â”‚
â”‚       name: str,                                                        â”‚
â”‚       email: str,                                                       â”‚
â”‚       password: str,                                                    â”‚
â”‚       db: Session = Depends(get_db)                                     â”‚
â”‚   ):                                                                    â”‚
â”‚       # 1. Check if email already exists                               â”‚
â”‚       existing = db.query(User).filter(                                 â”‚
â”‚           User.email == email                                           â”‚
â”‚       ).first()                                                         â”‚
â”‚                                                                          â”‚
â”‚       if existing:                                                      â”‚
â”‚           raise HTTPException(400, "Email already registered")          â”‚
â”‚                                                                          â”‚
â”‚       # 2. Hash the password                                            â”‚
â”‚       hashed_password = hash_password(password)                         â”‚
â”‚       # "mypass123" â†’ "$2b$12$KpVq..."                                  â”‚
â”‚                                                                          â”‚
â”‚       # 3. Create user object                                           â”‚
â”‚       new_user = User(                                                  â”‚
â”‚           name=name,                                                    â”‚
â”‚           email=email,                                                  â”‚
â”‚           password=hashed_password,                                     â”‚
â”‚           is_admin=False,                                               â”‚
â”‚           created_at=datetime.utcnow()                                  â”‚
â”‚       )                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: DATABASE (PostgreSQL)                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SQLAlchemy converts to SQL and executes:                                â”‚
â”‚                                                                          â”‚
â”‚   db.add(new_user)                                                      â”‚
â”‚   db.commit()                                                           â”‚
â”‚                                                                          â”‚
â”‚ SQL executed:                                                           â”‚
â”‚   INSERT INTO users (name, email, password, is_admin, created_at)      â”‚
â”‚   VALUES (                                                              â”‚
â”‚     'John Doe',                                                         â”‚
â”‚     'john@email.com',                                                   â”‚
â”‚     '$2b$12$KpVq...',                                                   â”‚
â”‚     false,                                                              â”‚
â”‚     '2025-12-30 10:30:00'                                               â”‚
â”‚   );                                                                    â”‚
â”‚                                                                          â”‚
â”‚ User now stored in database!                                            â”‚
â”‚ Auto-generated id = 1                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: BACKEND RESPONSE                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Backend sends response:                                                 â”‚
â”‚                                                                          â”‚
â”‚   return {"message": "User created successfully"}                       â”‚
â”‚                                                                          â”‚
â”‚ HTTP Response: 200 OK                                                   â”‚
â”‚   {                                                                     â”‚
â”‚     "message": "User created successfully"                              â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
                    [DATA TRAVELS BACK OVER NETWORK]
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: FRONTEND HANDLES RESPONSE                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AuthContext receives response:                                          â”‚
â”‚                                                                          â”‚
â”‚   const response = await authAPI.signup(...);                           â”‚
â”‚   // response.data = {"message": "User created successfully"}           â”‚
â”‚                                                                          â”‚
â”‚   toast.success("Account created! Please login");                       â”‚
â”‚   navigate('/login');  // Redirect to login page                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 8: USER SEES RESULT                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - Green toast notification: "Account created! Please login"             â”‚
â”‚ - Redirected to login page                                              â”‚
â”‚ - User can now login with credentials                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COMPLETE!


FLOW 2: USER LOGIN
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: USER ENTERS CREDENTIALS                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Login.jsx form:                                                         â”‚
â”‚   - Email: "john@email.com"                                             â”‚
â”‚   - Password: "mypass123"                                               â”‚
â”‚   - Clicks "Login"                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: API REQUEST                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ POST http://localhost:8000/login                                        â”‚
â”‚ Body: { "email": "john@email.com", "password": "mypass123" }            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: BACKEND AUTHENTICATION                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @app.post("/login"):                                                    â”‚
â”‚                                                                          â”‚
â”‚   # 1. Find user by email                                               â”‚
â”‚   user = db.query(User).filter(                                         â”‚
â”‚       User.email == "john@email.com"                                    â”‚
â”‚   ).first()                                                             â”‚
â”‚                                                                          â”‚
â”‚   # Database returns: User(id=1, name="John", email="...", ...)         â”‚
â”‚                                                                          â”‚
â”‚   if not user:                                                          â”‚
â”‚       raise HTTPException(401, "Invalid credentials")                   â”‚
â”‚                                                                          â”‚
â”‚   # 2. Verify password                                                  â”‚
â”‚   is_valid = verify_password(                                           â”‚
â”‚       plain="mypass123",                                                â”‚
â”‚       hashed=user.password  # "$2b$12$KpVq..."                          â”‚
â”‚   )                                                                     â”‚
â”‚   # Returns: True                                                       â”‚
â”‚                                                                          â”‚
â”‚   if not is_valid:                                                      â”‚
â”‚       raise HTTPException(401, "Invalid credentials")                   â”‚
â”‚                                                                          â”‚
â”‚   # 3. Create JWT token                                                 â”‚
â”‚   token = create_access_token({                                         â”‚
â”‚       "user_id": user.id,      # 1                                      â”‚
â”‚       "email": user.email,     # "john@email.com"                       â”‚
â”‚       "is_admin": user.is_admin # false                                 â”‚
â”‚   })                                                                    â”‚
â”‚   # Token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."                    â”‚
â”‚                                                                          â”‚
â”‚   # 4. Return token and user info                                       â”‚
â”‚   return {                                                              â”‚
â”‚       "access_token": token,                                            â”‚
â”‚       "token_type": "bearer",                                           â”‚
â”‚       "user": {                                                         â”‚
â”‚           "id": 1,                                                      â”‚
â”‚           "name": "John Doe",                                           â”‚
â”‚           "email": "john@email.com",                                    â”‚
â”‚           "is_admin": false                                             â”‚
â”‚       }                                                                 â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: FRONTEND STORES AUTH DATA                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AuthContext processes response:                                         â”‚
â”‚                                                                          â”‚
â”‚   const response = await authAPI.login(email, password);                â”‚
â”‚   const { access_token, user } = response.data;                         â”‚
â”‚                                                                          â”‚
â”‚   # Store in localStorage (persists across browser refresh)             â”‚
â”‚   localStorage.setItem('token', access_token);                          â”‚
â”‚   localStorage.setItem('user', JSON.stringify(user));                   â”‚
â”‚                                                                          â”‚
â”‚   # Update context state                                                â”‚
â”‚   setUser(user);                                                        â”‚
â”‚   setToken(access_token);                                               â”‚
â”‚   setIsAdmin(user.is_admin);                                            â”‚
â”‚                                                                          â”‚
â”‚   # Navigate to dashboard                                               â”‚
â”‚   navigate('/dashboard');                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: USER NOW LOGGED IN                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - Dashboard loads                                                       â”‚
â”‚ - User info shown in profile dropdown                                   â”‚
â”‚ - JWT token automatically included in all API requests                  â”‚
â”‚ - Token stored in browser (remains logged in until logout/expiry)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COMPLETE!


FLOW 3: DISEASE DETECTION (SINGLE IMAGE)
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: USER UPLOADS IMAGE                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dashboard.jsx:                                                          â”‚
â”‚   - User drags tomato leaf image into dropzone                          â”‚
â”‚   - ImageUpload.jsx handles file:                                       â”‚
â”‚       â€¢ Validates it's an image                                         â”‚
â”‚       â€¢ Creates preview thumbnail                                       â”‚
â”‚       â€¢ Stores in state: setFiles([file])                               â”‚
â”‚   - Preview shows on screen                                             â”‚
â”‚   - "Analyze" button becomes active                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: USER CLICKS "ANALYZE"                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ handleAnalyze() function:                                               â”‚
â”‚                                                                          â”‚
â”‚   const handleAnalyze = async () => {                                   â”‚
â”‚     setLoading(true);  // Show loading spinner                          â”‚
â”‚                                                                          â”‚
â”‚     try {                                                               â”‚
â”‚       const response = await predictionAPI.predict(files[0]);           â”‚
â”‚       setResults(response.data);                                        â”‚
â”‚     } catch (err) {                                                     â”‚
â”‚       toast.error("Analysis failed");                                   â”‚
â”‚     } finally {                                                         â”‚
â”‚       setLoading(false);  // Hide spinner                               â”‚
â”‚     }                                                                   â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: API SERVICE PREPARES REQUEST                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ predictionAPI.predict():                                                â”‚
â”‚                                                                          â”‚
â”‚   predict: (file) => {                                                  â”‚
â”‚     const formData = new FormData();                                    â”‚
â”‚     formData.append('file', file);                                      â”‚
â”‚                                                                          â”‚
â”‚     return api.post('/predict', formData, {                             â”‚
â”‚       headers: {                                                        â”‚
â”‚         'Content-Type': 'multipart/form-data',                          â”‚
â”‚         'Authorization': `Bearer ${token}`  // JWT token                â”‚
â”‚       }                                                                 â”‚
â”‚     });                                                                 â”‚
â”‚   }                                                                     â”‚
â”‚                                                                          â”‚
â”‚ HTTP Request:                                                           â”‚
â”‚   POST http://localhost:8000/predict                                    â”‚
â”‚   Headers:                                                              â”‚
â”‚     Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...       â”‚
â”‚   Body: (multipart/form-data)                                           â”‚
â”‚     file: [binary image data]                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: BACKEND RECEIVES REQUEST                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @app.post("/predict"):                                                  â”‚
â”‚                                                                          â”‚
â”‚   # 1. Verify JWT token (Dependency)                                    â”‚
â”‚   current_user = get_current_active_user(token)                         â”‚
â”‚   # Returns: User(id=1, name="John", ...)                               â”‚
â”‚                                                                          â”‚
â”‚   # 2. Receive uploaded file                                            â”‚
â”‚   file: UploadFile = File(...)                                          â”‚
â”‚   # file.filename = "tomato_leaf.jpg"                                   â”‚
â”‚   # file.content_type = "image/jpeg"                                    â”‚
â”‚                                                                          â”‚
â”‚   # 3. Validate file                                                    â”‚
â”‚   if not file.content_type.startswith("image/"):                        â”‚
â”‚       raise HTTPException(400, "Not an image")                          â”‚
â”‚                                                                          â”‚
â”‚   # 4. Read file content                                                â”‚
â”‚   contents = await file.read()                                          â”‚
â”‚   # Binary data of image                                                â”‚
â”‚                                                                          â”‚
â”‚   # 5. Check file size (max 10MB)                                       â”‚
â”‚   if len(contents) > 10 * 1024 * 1024:                                  â”‚
â”‚       raise HTTPException(400, "File too large")                        â”‚
â”‚                                                                          â”‚
â”‚   # 6. Open as PIL Image                                                â”‚
â”‚   image = Image.open(io.BytesIO(contents)).convert('RGB')               â”‚
â”‚   # Now have PIL Image object                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: AI MODEL PREDICTION (predictor.py)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   result = predictor.predict(image, return_all=True)                    â”‚
â”‚                                                                          â”‚
â”‚ Inside predictor.predict():                                             â”‚
â”‚                                                                          â”‚
â”‚   # 1. Preprocess image                                                 â”‚
â”‚   img_tensor = transform(image)  # Resize, crop, normalize              â”‚
â”‚   # Shape: [3, 224, 224] (RGB, 224x224 pixels)                          â”‚
â”‚                                                                          â”‚
â”‚   img_tensor = img_tensor.unsqueeze(0)  # Add batch dimension           â”‚
â”‚   # Shape: [1, 3, 224, 224]                                             â”‚
â”‚                                                                          â”‚
â”‚   # 2. Run through neural network                                       â”‚
â”‚   with torch.no_grad():  # Don't track gradients                        â”‚
â”‚       outputs = model(img_tensor)                                       â”‚
â”‚       # Shape: [1, 44] (1 image, 44 class scores)                       â”‚
â”‚       # Example: [-2.3, 5.8, -1.2, 1.5, ...]                            â”‚
â”‚                                                                          â”‚
â”‚   # 3. Convert to probabilities (softmax)                               â”‚
â”‚   probabilities = torch.nn.functional.softmax(outputs, dim=1)           â”‚
â”‚   # Shape: [1, 44] (probabilities sum to 1.0)                           â”‚
â”‚   # Example: [0.01, 0.95, 0.01, 0.02, ...]                              â”‚
â”‚                                                                          â”‚
â”‚   # 4. Get top prediction                                               â”‚
â”‚   confidence, predicted_idx = torch.max(probabilities, 1)               â”‚
â”‚   # confidence = 0.95                                                   â”‚
â”‚   # predicted_idx = 1                                                   â”‚
â”‚                                                                          â”‚
â”‚   # 5. Convert index to disease name                                    â”‚
â”‚   class_name = class_mapping["1"]  # "Tomato__Late_blight"              â”‚
â”‚                                                                          â”‚
â”‚   # 6. Get top 3 predictions                                            â”‚
â”‚   top_k = torch.topk(probabilities, 3)                                  â”‚
â”‚   top_predictions = [                                                   â”‚
â”‚       {"class_name": "Tomato__Late_blight", "confidence": 0.95},        â”‚
â”‚       {"class_name": "Tomato__Early_blight", "confidence": 0.03},       â”‚
â”‚       {"class_name": "Tomato_healthy", "confidence": 0.01}              â”‚
â”‚   ]                                                                     â”‚
â”‚                                                                          â”‚
â”‚   # 7. Return result                                                    â”‚
â”‚   return {                                                              â”‚
â”‚       "class_name": "Tomato__Late_blight",                              â”‚
â”‚       "confidence": 0.95,                                               â”‚
â”‚       "top_k": top_predictions                                          â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: BACKEND FORMATS RESPONSE                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @app.post("/predict") continues:                                        â”‚
â”‚                                                                          â”‚
â”‚   result = predictor.predict(image, return_all=True)                    â”‚
â”‚                                                                          â”‚
â”‚   return JSONResponse(content={                                         â”‚
â”‚       "predicted_class": result['class_name'],                          â”‚
â”‚       "confidence": round(result['confidence'], 4),                     â”‚
â”‚       "top_predictions": result['top_k'],                               â”‚
â”‚       "filename": file.filename                                         â”‚
â”‚   })                                                                    â”‚
â”‚                                                                          â”‚
â”‚ HTTP Response: 200 OK                                                   â”‚
â”‚   {                                                                     â”‚
â”‚     "predicted_class": "Tomato__Late_blight",                           â”‚
â”‚     "confidence": 0.95,                                                 â”‚
â”‚     "top_predictions": [                                                â”‚
â”‚       {"class_name": "Tomato__Late_blight", "confidence": 0.95},        â”‚
â”‚       {"class_name": "Tomato__Early_blight", "confidence": 0.03},       â”‚
â”‚       {"class_name": "Tomato_healthy", "confidence": 0.01}              â”‚
â”‚     ],                                                                  â”‚
â”‚     "filename": "tomato_leaf.jpg"                                       â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: FRONTEND RECEIVES AND PROCESSES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dashboard.jsx handleAnalyze() continues:                                â”‚
â”‚                                                                          â”‚
â”‚   const response = await predictionAPI.predict(files[0]);               â”‚
â”‚   # response.data = { predicted_class: "...", confidence: 0.95, ... }   â”‚
â”‚                                                                          â”‚
â”‚   # 1. Display results                                                  â”‚
â”‚   setResults(response.data);                                            â”‚
â”‚   # Results.jsx now renders the prediction                              â”‚
â”‚                                                                          â”‚
â”‚   # 2. Save to history (database)                                       â”‚
â”‚   await addToHistory({                                                  â”‚
â”‚       type: 'single',                                                   â”‚
â”‚       disease: response.data.predicted_class,                           â”‚
â”‚       confidence: response.data.confidence,                             â”‚
â”‚       imageName: response.data.filename,                                â”‚
â”‚       alternatives: response.data.top_predictions,                      â”‚
â”‚       remedyInfo: {}                                                    â”‚
â”‚   });                                                                   â”‚
â”‚                                                                          â”‚
â”‚   # 3. Show success message                                             â”‚
â”‚   toast.success('Analysis complete!');                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 8: SAVE TO HISTORY DATABASE                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ addToHistory() in HistoryContext:                                       â”‚
â”‚                                                                          â”‚
â”‚   # API request                                                         â”‚
â”‚   POST http://localhost:8000/history/diagnosis                          â”‚
â”‚   Body: {                                                               â”‚
â”‚     "diagnosis_type": "single",                                         â”‚
â”‚     "image_name": "tomato_leaf.jpg",                                    â”‚
â”‚     "disease_name": "Tomato__Late_blight",                              â”‚
â”‚     "confidence": 0.95,                                                 â”‚
â”‚     "alternatives": [...],                                              â”‚
â”‚     "remedy_info": {}                                                   â”‚
â”‚   }                                                                     â”‚
â”‚                                                                          â”‚
â”‚ Backend @app.post("/history/diagnosis"):                                â”‚
â”‚   new_diagnosis = DiagnosisHistory(                                     â”‚
â”‚       user_id=1,  # From JWT token                                      â”‚
â”‚       diagnosis_type="single",                                          â”‚
â”‚       image_name="tomato_leaf.jpg",                                     â”‚
â”‚       disease_name="Tomato__Late_blight",                               â”‚
â”‚       confidence=0.95,                                                  â”‚
â”‚       alternatives=[...],  # Stored as JSON                             â”‚
â”‚       remedy_info={},      # Stored as JSON                             â”‚
â”‚       diagnosed_at=datetime.utcnow(),                                   â”‚
â”‚       status="active"                                                   â”‚
â”‚   )                                                                     â”‚
â”‚   db.add(new_diagnosis)                                                 â”‚
â”‚   db.commit()                                                           â”‚
â”‚                                                                          â”‚
â”‚ Database INSERT executed:                                               â”‚
â”‚   INSERT INTO diagnosis_history (...) VALUES (...);                     â”‚
â”‚   # New row created with id=1                                           â”‚
â”‚                                                                          â”‚
â”‚ Response: { "diagnosis_id": 1 }                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 9: UPDATE UI                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ HistoryContext updates local state:                                     â”‚
â”‚   setHistory([newEntry, ...prev]);                                      â”‚
â”‚                                                                          â”‚
â”‚ Results component displays:                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚   â”‚ ğŸƒ Tomato Late Blight              â”‚                               â”‚
â”‚   â”‚ Confidence: 95%                    â”‚                               â”‚
â”‚   â”‚                                    â”‚                               â”‚
â”‚   â”‚ Alternatives:                      â”‚                               â”‚
â”‚   â”‚ â€¢ Tomato Early Blight (3%)         â”‚                               â”‚
â”‚   â”‚ â€¢ Tomato Healthy (1%)              â”‚                               â”‚
â”‚   â”‚                                    â”‚                               â”‚
â”‚   â”‚ [View Remedy] [Save to Garden]     â”‚                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                          â”‚
â”‚ History sidebar updates:                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚   â”‚ ğŸ“œ Analysis History                â”‚                               â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
â”‚   â”‚ ğŸ–¼ï¸ Single Â· Just now               â”‚                               â”‚
â”‚   â”‚ Tomato Late Blight (95%)           â”‚                               â”‚
â”‚   â”‚ tomato_leaf.jpg                    â”‚                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COMPLETE! User can now see diagnosis and it's saved in database forever.


FLOW 4: VIEWING HISTORY
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: USER OPENS DASHBOARD                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dashboard.jsx loads â†’ HistoryContext mounts                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: HISTORYCONTEXT FETCHES DATA                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ useEffect in HistoryContext.jsx:                                        â”‚
â”‚                                                                          â”‚
â”‚   useEffect(() => {                                                     â”‚
â”‚     const loadHistory = async () => {                                   â”‚
â”‚       setLoading(true);                                                 â”‚
â”‚                                                                          â”‚
â”‚       const response = await historyAPI.getHistory(50, 0);              â”‚
â”‚       # GET http://localhost:8000/history/diagnosis?limit=50&offset=0   â”‚
â”‚                                                                          â”‚
â”‚       setHistory(response.data.history);                                â”‚
â”‚       setTotal(response.data.total);                                    â”‚
â”‚       setLoading(false);                                                â”‚
â”‚     };                                                                  â”‚
â”‚                                                                          â”‚
â”‚     loadHistory();                                                      â”‚
â”‚   }, []);  // Runs once on mount                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: BACKEND QUERIES DATABASE                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @app.get("/history/diagnosis"):                                         â”‚
â”‚                                                                          â”‚
â”‚   # Get current user from JWT                                           â”‚
â”‚   current_user = get_current_active_user(token)  # User(id=1)           â”‚
â”‚                                                                          â”‚
â”‚   # Query diagnoses                                                     â”‚
â”‚   diagnoses = db.query(DiagnosisHistory)\                               â”‚
â”‚                 .filter(DiagnosisHistory.user_id == 1)\                 â”‚
â”‚                 .order_by(DiagnosisHistory.diagnosed_at.desc())\        â”‚
â”‚                 .limit(50)\                                             â”‚
â”‚                 .offset(0)\                                             â”‚
â”‚                 .all()                                                  â”‚
â”‚                                                                          â”‚
â”‚   # SQL executed:                                                       â”‚
â”‚   # SELECT * FROM diagnosis_history                                     â”‚
â”‚   # WHERE user_id = 1                                                   â”‚
â”‚   # ORDER BY diagnosed_at DESC                                          â”‚
â”‚   # LIMIT 50 OFFSET 0;                                                  â”‚
â”‚                                                                          â”‚
â”‚   # Count total                                                         â”‚
â”‚   total = db.query(DiagnosisHistory)\                                   â”‚
â”‚             .filter(DiagnosisHistory.user_id == 1)\                     â”‚
â”‚             .count()                                                    â”‚
â”‚   # Returns: 3                                                          â”‚
â”‚                                                                          â”‚
â”‚   # Return response                                                     â”‚
â”‚   return {                                                              â”‚
â”‚       "history": [                                                      â”‚
â”‚           {                                                             â”‚
â”‚               "id": 3,                                                  â”‚
â”‚               "disease_name": "Tomato__Late_blight",                    â”‚
â”‚               "confidence": 0.95,                                       â”‚
â”‚               "diagnosed_at": "2025-12-30T10:30:00",                    â”‚
â”‚               ...                                                       â”‚
â”‚           },                                                            â”‚
â”‚           {                                                             â”‚
â”‚               "id": 2,                                                  â”‚
â”‚               "disease_name": "Apple___Apple_scab",                     â”‚
â”‚               "confidence": 0.89,                                       â”‚
â”‚               "diagnosed_at": "2025-12-29T15:20:00",                    â”‚
â”‚               ...                                                       â”‚
â”‚           },                                                            â”‚
â”‚           {                                                             â”‚
â”‚               "id": 1,                                                  â”‚
â”‚               "disease_name": "Potato___Late_blight",                   â”‚
â”‚               "confidence": 0.92,                                       â”‚
â”‚               "diagnosed_at": "2025-12-28T09:15:00",                    â”‚
â”‚               ...                                                       â”‚
â”‚           }                                                             â”‚
â”‚       ],                                                                â”‚
â”‚       "total": 3                                                        â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: FRONTEND DISPLAYS HISTORY                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ History.jsx component renders:                                          â”‚
â”‚                                                                          â”‚
â”‚   {history.map((item) => (                                              â”‚
â”‚     <div className="history-item">                                      â”‚
â”‚       <span className="type-badge">                                     â”‚
â”‚         {item.diagnosis_type === 'single' ? 'ğŸ–¼ï¸ Single' : 'ğŸ“ Batch'}  â”‚
â”‚       </span>                                                           â”‚
â”‚       <strong>{item.disease_name}</strong>                              â”‚
â”‚       <span>{(item.confidence * 100).toFixed(1)}%</span>                â”‚
â”‚       <small>{formatDate(item.diagnosed_at)}</small>                    â”‚
â”‚       <button onClick={() => deleteHistoryItem(item.id)}>ğŸ—‘ï¸</button>   â”‚
â”‚     </div>                                                              â”‚
â”‚   ))}                                                                   â”‚
â”‚                                                                          â”‚
â”‚ User sees:                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚   â”‚ ğŸ“œ Analysis History      [Clear All]    â”‚                           â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚
â”‚   â”‚ ğŸ–¼ï¸ Single Â· Just now              ğŸ—‘ï¸   â”‚                           â”‚
â”‚   â”‚ Tomato Late Blight                     â”‚                           â”‚
â”‚   â”‚ 95% Â· tomato_leaf.jpg                  â”‚                           â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚
â”‚   â”‚ ğŸ–¼ï¸ Single Â· 1 day ago              ğŸ—‘ï¸  â”‚                           â”‚
â”‚   â”‚ Apple Apple Scab                       â”‚                           â”‚
â”‚   â”‚ 89% Â· apple.jpg                        â”‚                           â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚
â”‚   â”‚ ğŸ–¼ï¸ Single Â· 2 days ago             ğŸ—‘ï¸  â”‚                           â”‚
â”‚   â”‚ Potato Late Blight                     â”‚                           â”‚
â”‚   â”‚ 92% Â· potato_leaf.jpg                  â”‚                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COMPLETE! History loaded from database and displayed.


AUTHENTICATION FLOW (HOW JWT WORKS)
================================================================================

Every authenticated API request follows this pattern:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND SENDS REQUEST                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ axios interceptor (in api.js) automatically adds token:                 â”‚
â”‚                                                                          â”‚
â”‚   api.interceptors.request.use(config => {                              â”‚
â”‚     const token = localStorage.getItem('token');                        â”‚
â”‚     if (token) {                                                        â”‚
â”‚       config.headers.Authorization = `Bearer ${token}`;                 â”‚
â”‚     }                                                                   â”‚
â”‚     return config;                                                      â”‚
â”‚   });                                                                   â”‚
â”‚                                                                          â”‚
â”‚ Every request now has:                                                  â”‚
â”‚   Headers: {                                                            â”‚
â”‚     Authorization: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."      â”‚
â”‚   }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND VERIFIES TOKEN (Dependency)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Every protected endpoint has:                                           â”‚
â”‚   current_user: User = Depends(get_current_active_user)                 â”‚
â”‚                                                                          â”‚
â”‚ get_current_active_user() function:                                     â”‚
â”‚   1. Extracts token from Authorization header                           â”‚
â”‚   2. Decodes JWT: jwt.decode(token, SECRET_KEY)                         â”‚
â”‚   3. Gets user_id from payload                                          â”‚
â”‚   4. Queries database: db.query(User).filter(User.id == user_id)        â”‚
â”‚   5. Returns User object                                                â”‚
â”‚                                                                          â”‚
â”‚ If token invalid/expired:                                               â”‚
â”‚   â†’ Raises HTTPException(401, "Invalid token")                          â”‚
â”‚   â†’ Frontend receives 401 error                                         â”‚
â”‚   â†’ AuthContext catches error                                           â”‚
â”‚   â†’ Logs user out                                                       â”‚
â”‚   â†’ Redirects to login                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

This happens AUTOMATICALLY for every API call after login!


KEY TAKEAWAYS
================================================================================

1. FRONTEND â†’ BACKEND â†’ DATABASE â†’ BACKEND â†’ FRONTEND
   Data flows in this pattern for all operations

2. JWT AUTHENTICATION
   Token in every request, backend verifies, extracts user

3. REACT CONTEXT
   Shares state (user, theme, history) across all components

4. API SERVICE LAYER
   Centralizes all backend communication in one file

5. SQLALCHEMY ORM
   Python code â†’ SQL automatically

6. AI MODEL
   Image â†’ Preprocess â†’ Neural Network â†’ Probabilities â†’ Disease name

7. ERROR HANDLING
   Try-catch blocks, HTTP status codes, toast notifications

8. LOADING STATES
   Spinners while waiting for responses

9. REAL-TIME UI UPDATES
   State changes â†’ Component re-renders automatically

10. PERSISTENT STORAGE
    Database for permanent data, localStorage for browser session
